# è¯­éŸ³å­—å¹•é›†æˆæ–¹æ¡ˆ

> åŸºäº WavespeedAI API å’Œ MoneyPrinterTurbo å®è·µç»éªŒçš„å®Œæ•´è§£å†³æ–¹æ¡ˆ

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2025-12-23
**ç›®æ ‡**: ä¸º ad-aka.py æ·»åŠ è¯­éŸ³åˆæˆã€å­—å¹•ç”Ÿæˆå’Œå­—å¹•æ ·å¼åŠŸèƒ½

---

## ğŸ“‹ ç›®å½•

- [æ–¹æ¡ˆæ¦‚è¿°](#æ–¹æ¡ˆæ¦‚è¿°)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [å®ç°æ–¹æ¡ˆå¯¹æ¯”](#å®ç°æ–¹æ¡ˆå¯¹æ¯”)
- [æ¨èæ–¹æ¡ˆè¯¦è§£](#æ¨èæ–¹æ¡ˆè¯¦è§£)
- [æ ¸å¿ƒæ¨¡å—è®¾è®¡](#æ ¸å¿ƒæ¨¡å—è®¾è®¡)
- [å·¥ä½œæµæ”¹è¿›](#å·¥ä½œæµæ”¹è¿›)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [æˆæœ¬åˆ†æ](#æˆæœ¬åˆ†æ)
- [å¼€å‘è·¯çº¿å›¾](#å¼€å‘è·¯çº¿å›¾)

---

## æ–¹æ¡ˆæ¦‚è¿°

### å½“å‰çŠ¶æ€

**ç°æœ‰åŠŸèƒ½** âœ…
- DeepSeek æ•…äº‹ç”Ÿæˆ
- WavespeedAI å›¾åƒç”Ÿæˆï¼ˆSeedream v4ï¼‰
- WAN 2.5 I2V è§†é¢‘ç”Ÿæˆ
- MoviePy è§†é¢‘æ‹¼æ¥
- æ™ºèƒ½æ–­ç‚¹ç»­ä¼ 

**ç¼ºå¤±åŠŸèƒ½** âŒ
- è¯­éŸ³é…éŸ³ï¼ˆæ—ç™½ï¼‰
- å­—å¹•ç”Ÿæˆ
- å­—å¹•æ ·å¼è‡ªå®šä¹‰
- èƒŒæ™¯éŸ³ä¹
- éŸ³è§†é¢‘åˆæˆ

### ç›®æ ‡æ•ˆæœ

**å®Œæ•´è§†é¢‘** = è§†é¢‘ç”»é¢ + é…éŸ³ + å­—å¹• + èƒŒæ™¯éŸ³ä¹

---

## æŠ€æœ¯æ¶æ„

### å®Œæ•´å·¥ä½œæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ç”¨æˆ·è¾“å…¥ï¼ˆä¸»é¢˜+é£æ ¼+å‚æ•°ï¼‰                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            é˜¶æ®µ1: æ•…äº‹ç”Ÿæˆï¼ˆDeepSeekï¼‰                    â”‚
â”‚  â€¢ ç”Ÿæˆæ•…äº‹å¤§çº²ï¼ˆèµ·æ‰¿è½¬åˆï¼‰                                â”‚
â”‚  â€¢ ç”Ÿæˆåˆ†é•œè„šæœ¬ï¼ˆç”»é¢æè¿° + æ—ç™½æ–‡æ¡ˆï¼‰                      â”‚
â”‚  è¾“å‡º: shots_script.json                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é˜¶æ®µ2a: é…éŸ³ç”Ÿæˆï¼ˆæ–¹æ¡ˆé€‰æ‹©ï¼‰                       â”‚
â”‚  ã€æ–¹æ¡ˆAã€‘Qwen TTS (WavespeedAI)                         â”‚
â”‚    â€¢ ä¸ºæ¯ä¸ªé•œå¤´çš„æ—ç™½ç”Ÿæˆé…éŸ³                              â”‚
â”‚    â€¢ æˆæœ¬: ~$0.01/é•œå¤´                                   â”‚
â”‚    â€¢ è¾“å‡º: shot_X_audio.mp3 + éŸ³é¢‘æ—¶é•¿                   â”‚
â”‚                                                          â”‚
â”‚  ã€æ–¹æ¡ˆBã€‘Edge TTS (å…è´¹ï¼Œå‚è€ƒMoneyé¡¹ç›®)                  â”‚
â”‚    â€¢ ä¸ºæ¯ä¸ªé•œå¤´çš„æ—ç™½ç”Ÿæˆé…éŸ³                              â”‚
â”‚    â€¢ æˆæœ¬: $0                                            â”‚
â”‚    â€¢ è¾“å‡º: shot_X_audio.mp3 + SubMakerå¯¹è±¡              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é˜¶æ®µ2b: å­—å¹•ç”Ÿæˆï¼ˆæ–¹æ¡ˆé€‰æ‹©ï¼‰                       â”‚
â”‚  ã€æ–¹æ¡ˆAã€‘Whisper (WavespeedAI) - ç²¾ç¡®                   â”‚
â”‚    â€¢ ä»éŸ³é¢‘è¯†åˆ«ç”Ÿæˆå­—å¹•                                   â”‚
â”‚    â€¢ è‡ªåŠ¨æ—¶é—´æˆ³å¯¹é½                                       â”‚
â”‚    â€¢ æˆæœ¬: ~$0.01/é•œå¤´                                   â”‚
â”‚    â€¢ è¾“å‡º: shot_X_subtitle.srt                          â”‚
â”‚                                                          â”‚
â”‚  ã€æ–¹æ¡ˆBã€‘åŸºäºæ–‡æ¡ˆç”Ÿæˆï¼ˆç®€å•å¿«é€Ÿï¼‰                         â”‚
â”‚    â€¢ ä»æ—ç™½æ–‡æ¡ˆç›´æ¥ç”Ÿæˆ                                   â”‚
â”‚    â€¢ æ ¹æ®éŸ³é¢‘æ—¶é•¿å¹³å‡åˆ†é…                                 â”‚
â”‚    â€¢ æˆæœ¬: $0                                            â”‚
â”‚    â€¢ è¾“å‡º: shot_X_subtitle.srt                          â”‚
â”‚                                                          â”‚
â”‚  ã€æ–¹æ¡ˆCã€‘Edge TTS SubMakerï¼ˆMoneyé¡¹ç›®æ–¹æ¡ˆï¼‰             â”‚
â”‚    â€¢ ç›´æ¥ä½¿ç”¨TTSè¿”å›çš„æ—¶é—´æˆ³                              â”‚
â”‚    â€¢ æœ€ç²¾ç¡®çš„æ—¶é—´å¯¹é½                                     â”‚
â”‚    â€¢ æˆæœ¬: $0ï¼ˆéœ€é…åˆEdge TTSï¼‰                          â”‚
â”‚    â€¢ è¾“å‡º: shot_X_subtitle.srt                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          é˜¶æ®µ2c: å›¾åƒç”Ÿæˆï¼ˆç°æœ‰æµç¨‹ï¼‰                      â”‚
â”‚  â€¢ å¹¶å‘ç”Ÿæˆå…³é”®å¸§å›¾åƒï¼ˆSeedream v4ï¼‰                      â”‚
â”‚  â€¢ è¾“å‡º: shot_X_image.png                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          é˜¶æ®µ2d: è§†é¢‘ç”Ÿæˆï¼ˆç°æœ‰æµç¨‹ï¼‰                      â”‚
â”‚  â€¢ å›¾åƒâ†’è§†é¢‘ï¼ˆWAN 2.5 I2Vï¼‰                              â”‚
â”‚  â€¢ è¾“å‡º: shot_X.mp4ï¼ˆé™éŸ³è§†é¢‘ï¼‰                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é˜¶æ®µ3: èƒŒæ™¯éŸ³ä¹ç”Ÿæˆï¼ˆå¯é€‰ï¼‰                        â”‚
â”‚  ã€æ–¹æ¡ˆAã€‘AIç”Ÿæˆï¼ˆWavespeedAIï¼‰                           â”‚
â”‚    â€¢ æ ¹æ®è§†é¢‘é£æ ¼ç”ŸæˆéŸ³ä¹                                 â”‚
â”‚    â€¢ æˆæœ¬: ~$0.05/è§†é¢‘                                   â”‚
â”‚                                                          â”‚
â”‚  ã€æ–¹æ¡ˆBã€‘æœ¬åœ°éŸ³ä¹åº“ï¼ˆMoneyé¡¹ç›®æ–¹æ¡ˆï¼‰                      â”‚
â”‚    â€¢ ä»resource/songs/éšæœºé€‰æ‹©                          â”‚
â”‚    â€¢ æˆæœ¬: $0                                            â”‚
â”‚  è¾“å‡º: background_music.mp3                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é˜¶æ®µ4: éŸ³è§†é¢‘åˆæˆï¼ˆMoviePyï¼‰                      â”‚
â”‚  1. è§†é¢‘ç‰‡æ®µ + é…éŸ³éŸ³é¢‘åˆæˆ                               â”‚
â”‚  2. æ·»åŠ å­—å¹•è½¨é“ï¼ˆæ ·å¼è‡ªå®šä¹‰ï¼‰                            â”‚
â”‚     â€¢ å­—ä½“ã€é¢œè‰²ã€ä½ç½®ã€æè¾¹                              â”‚
â”‚  3. æ··åˆèƒŒæ™¯éŸ³ä¹ï¼ˆéŸ³é‡å¯è°ƒï¼‰                              â”‚
â”‚     â€¢ é…éŸ³: 1.0, èƒŒæ™¯éŸ³ä¹: 0.2-0.3                       â”‚
â”‚  4. æ‹¼æ¥æ‰€æœ‰é•œå¤´                                         â”‚
â”‚  5. åº”ç”¨è½¬åœºæ•ˆæœ                                         â”‚
â”‚  è¾“å‡º: final_video.mp4ï¼ˆå®Œæ•´å¸¦éŸ³å­—å¹•è§†é¢‘ï¼‰               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å®ç°æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆAï¼šæ··åˆæ–¹æ¡ˆï¼ˆæ¨èï¼‰â­â­â­â­â­

**æŠ€æœ¯æ ˆ**
- é…éŸ³ï¼šEdge TTSï¼ˆå…è´¹ï¼‰
- å­—å¹•ï¼šåŸºäºTTS SubMakerï¼ˆå…è´¹ï¼Œæœ€ç²¾ç¡®ï¼‰
- èƒŒæ™¯éŸ³ä¹ï¼šæœ¬åœ°éŸ³ä¹åº“ï¼ˆå…è´¹ï¼‰
- åˆæˆï¼šMoviePy

**ä¼˜åŠ¿**
- âœ… **é›¶æˆæœ¬** - å®Œå…¨å…è´¹
- âœ… **å­—å¹•ç²¾ç¡®** - SubMakeræä¾›ç²¾ç¡®çš„å•è¯çº§æ—¶é—´æˆ³
- âœ… **å¼€å‘ç®€å•** - å‚è€ƒMoneyé¡¹ç›®ç°æˆä»£ç 
- âœ… **è´¨é‡ä¼˜ç§€** - Edge TTSè´¨é‡æ¥è¿‘å•†ä¸šTTS
- âœ… **æ–­ç‚¹ç»­ä¼ ** - æ˜“äºé›†æˆåˆ°ç°æœ‰æµç¨‹

**åŠ£åŠ¿**
- âš ï¸ ä¾èµ–Microsoft Edge TTSæœåŠ¡
- âš ï¸ éŸ³è‰²é€‰æ‹©ç›¸å¯¹æœ‰é™ï¼ˆä½†æ”¯æŒä¸­æ–‡å¤šç§éŸ³è‰²ï¼‰

**æˆæœ¬åˆ†æ**
```
å•é•œå¤´æˆæœ¬:
- å›¾åƒ: $0.027 (Seedream v4)
- è§†é¢‘: $0.30 (WAN 2.5 I2V)
- é…éŸ³: $0 (Edge TTS)
- å­—å¹•: $0 (SubMaker)
- èƒŒæ™¯éŸ³ä¹: $0 (æœ¬åœ°éŸ³ä¹åº“)
= $0.327/é•œå¤´

3é•œå¤´æ€»æˆæœ¬: ~$0.98
5é•œå¤´æ€»æˆæœ¬: ~$1.64
```

---

### æ–¹æ¡ˆBï¼šWavespeedAIå…¨å®¶æ¡¶

**æŠ€æœ¯æ ˆ**
- é…éŸ³ï¼šQwen TTSï¼ˆWavespeedAIï¼‰
- å­—å¹•ï¼šWhisperï¼ˆWavespeedAIï¼‰
- èƒŒæ™¯éŸ³ä¹ï¼šAIéŸ³ä¹ç”Ÿæˆï¼ˆWavespeedAIï¼‰
- åˆæˆï¼šMoviePy

**ä¼˜åŠ¿**
- âœ… **ç»Ÿä¸€å¹³å°** - æ‰€æœ‰AIæœåŠ¡åœ¨åŒä¸€å¹³å°
- âœ… **é«˜è´¨é‡** - å•†ä¸šçº§TTSå’ŒWhisper
- âœ… **å¯æ§æ€§å¼º** - æ¯ä¸ªç¯èŠ‚éƒ½å¯è°ƒæ•´å‚æ•°

**åŠ£åŠ¿**
- âš ï¸ æˆæœ¬è¾ƒé«˜ - æ¯ä¸ªAPIéƒ½éœ€ä»˜è´¹
- âš ï¸ APIè°ƒç”¨å¤æ‚ - éœ€è¦å¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡

**æˆæœ¬åˆ†æ**
```
å•é•œå¤´æˆæœ¬:
- å›¾åƒ: $0.027
- è§†é¢‘: $0.30
- é…éŸ³: ~$0.01 (Qwen TTSä¼°ç®—)
- å­—å¹•: ~$0.01 (Whisperä¼°ç®—)
- èƒŒæ™¯éŸ³ä¹: ~$0.01 (AIç”Ÿæˆä¼°ç®—ï¼Œæ•´ä¸ªè§†é¢‘å…±äº«)
= $0.357/é•œå¤´

3é•œå¤´æ€»æˆæœ¬: ~$1.08
5é•œå¤´æ€»æˆæœ¬: ~$1.80
```

---

### æ–¹æ¡ˆCï¼šæç®€æ–¹æ¡ˆï¼ˆä¸æ¨èï¼‰

**æŠ€æœ¯æ ˆ**
- ç›´æ¥ä½¿ç”¨ WAN 2.6 T2Vï¼ˆåŸç”ŸéŸ³è§†é¢‘åŒæ­¥ï¼‰
- å­—å¹•ï¼šWhisperè¯†åˆ«ç”Ÿæˆ

**ä¼˜åŠ¿**
- âœ… ä¸€æ­¥åˆ°ä½ - è§†é¢‘è‡ªå¸¦éŸ³é¢‘

**åŠ£åŠ¿**
- âŒ **æ— æ³•æ§åˆ¶** - éŸ³é¢‘å†…å®¹ç”±AIè‡ªåŠ¨ç”Ÿæˆ
- âŒ **æˆæœ¬é«˜** - WAN 2.6çº¦$0.50/é•œå¤´
- âŒ **ä¸ç¬¦åˆéœ€æ±‚** - æ— æ³•ä½¿ç”¨è‡ªå®šä¹‰æ—ç™½æ–‡æ¡ˆ

---

## æ¨èæ–¹æ¡ˆè¯¦è§£

### æ–¹æ¡ˆAï¼šæ··åˆæ–¹æ¡ˆï¼ˆæœ€ä½³æ€§ä»·æ¯”ï¼‰

#### ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªæ–¹æ¡ˆï¼Ÿ

1. **æˆæœ¬ä¼˜åŠ¿**ï¼šå®Œå…¨å…è´¹çš„é…éŸ³å’Œå­—å¹•æ–¹æ¡ˆ
2. **è´¨é‡ä¿è¯**ï¼šEdge TTSè´¨é‡æ¥è¿‘å•†ä¸šæ°´å¹³
3. **æŠ€æœ¯æˆç†Ÿ**ï¼šMoneyPrinterTurboå·²éªŒè¯å¯è¡Œæ€§
4. **ç²¾ç¡®å¯¹é½**ï¼šSubMakeræä¾›å•è¯çº§æ—¶é—´æˆ³
5. **æ˜“äºç»´æŠ¤**ï¼šä»£ç ç®€å•ï¼Œå‚è€ƒå®ç°æ¸…æ™°

#### æ ¸å¿ƒæŠ€æœ¯é€‰æ‹©

**1. é…éŸ³ï¼šEdge TTS**
```python
import edge_tts
import asyncio

async def generate_voice(text, voice_name, output_file):
    """
    ä½¿ç”¨Edge TTSç”Ÿæˆé…éŸ³

    Args:
        text: æ—ç™½æ–‡æ¡ˆ
        voice_name: éŸ³è‰²åç§°ï¼Œå¦‚"zh-CN-XiaoxiaoNeural"
        output_file: è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„

    Returns:
        sub_maker: SubMakerå¯¹è±¡ï¼ˆåŒ…å«æ—¶é—´æˆ³ï¼‰
        duration: éŸ³é¢‘æ—¶é•¿ï¼ˆç§’ï¼‰
    """
    communicate = edge_tts.Communicate(text, voice_name)
    sub_maker = edge_tts.SubMaker()

    with open(output_file, "wb") as file:
        async for chunk in communicate.stream():
            if chunk["type"] == "audio":
                file.write(chunk["data"])
            elif chunk["type"] == "WordBoundary":
                # è®°å½•æ¯ä¸ªå•è¯çš„æ—¶é—´æˆ³
                sub_maker.create_sub(
                    (chunk["offset"], chunk["duration"]),
                    chunk["text"]
                )

    # è®¡ç®—éŸ³é¢‘æ—¶é•¿
    duration = sub_maker.offset[-1][1] / 10000000 if sub_maker.offset else 0

    return sub_maker, duration
```

**æ¨èéŸ³è‰²ï¼ˆä¸­æ–‡ï¼‰**
- **å¥³å£°**: `zh-CN-XiaoxiaoNeural`ï¼ˆæ¸©æŸ”ï¼‰, `zh-CN-XiaoyiNeural`ï¼ˆæ´»æ³¼ï¼‰
- **ç”·å£°**: `zh-CN-YunxiNeural`ï¼ˆæˆç†Ÿï¼‰, `zh-CN-YunyangNeural`ï¼ˆå¹´è½»ï¼‰

**2. å­—å¹•ï¼šåŸºäºSubMakerç”Ÿæˆ**
```python
from edge_tts.submaker import mktimestamp

def create_subtitle_from_submaker(sub_maker, script_text, output_file):
    """
    ä»SubMakerç”ŸæˆSRTå­—å¹•æ–‡ä»¶

    Args:
        sub_maker: Edge TTSè¿”å›çš„SubMakerå¯¹è±¡
        script_text: åŸå§‹æ—ç™½æ–‡æ¡ˆ
        output_file: è¾“å‡ºSRTæ–‡ä»¶è·¯å¾„
    """
    # æŒ‰æ ‡ç‚¹ç¬¦å·åˆ†å‰²æ–‡æ¡ˆ
    script_lines = split_by_punctuation(script_text)

    # åŒ¹é…SubMakerçš„æ—¶é—´æˆ³å’Œæ–‡æ¡ˆè¡Œ
    subtitles = []
    current_line = ""
    start_time = None

    for (offset, duration), word in zip(sub_maker.offset, sub_maker.subs):
        if start_time is None:
            start_time = offset

        current_line += word

        # æ£€æŸ¥æ˜¯å¦åŒ¹é…å®Œæ•´å¥å­
        if matches_script_line(current_line, script_lines):
            end_time = offset + duration
            subtitles.append({
                'index': len(subtitles) + 1,
                'start': format_time(start_time),
                'end': format_time(end_time),
                'text': current_line.strip()
            })
            current_line = ""
            start_time = None

    # å†™å…¥SRTæ–‡ä»¶
    write_srt(subtitles, output_file)
```

**3. å­—å¹•æ ·å¼ï¼šMoviePyæ¸²æŸ“**
```python
from moviepy.editor import VideoFileClip, TextClip, CompositeVideoClip
from moviepy.video.tools import subtitles

def add_subtitles_to_video(video_file, subtitle_file, output_file, style_config):
    """
    ä¸ºè§†é¢‘æ·»åŠ æ ·å¼åŒ–å­—å¹•

    Args:
        video_file: è¾“å…¥è§†é¢‘æ–‡ä»¶
        subtitle_file: SRTå­—å¹•æ–‡ä»¶
        output_file: è¾“å‡ºè§†é¢‘æ–‡ä»¶
        style_config: å­—å¹•æ ·å¼é…ç½®
    """
    video = VideoFileClip(video_file)

    # ç”Ÿæˆå­—å¹•clips
    generator = lambda txt: TextClip(
        txt,
        font=style_config.get('font', 'STHeiti'),
        fontsize=style_config.get('fontsize', 48),
        color=style_config.get('color', 'white'),
        stroke_color=style_config.get('stroke_color', 'black'),
        stroke_width=style_config.get('stroke_width', 2),
        method='caption',
        size=(video.w * 0.9, None),
        align='center'
    )

    # è¯»å–å­—å¹•å¹¶åˆ›å»ºclips
    subs = subtitles.file_to_subtitles(subtitle_file)
    subtitle_clips = [
        generator(txt).set_position(('center', 'bottom'))
                     .set_start(start)
                     .set_duration(end - start)
        for ((start, end), txt) in subs
    ]

    # åˆæˆè§†é¢‘
    final = CompositeVideoClip([video] + subtitle_clips)
    final.write_videofile(output_file, codec='libx264', audio_codec='aac')
```

**4. éŸ³é¢‘æ··åˆ**
```python
from moviepy.editor import VideoFileClip, AudioFileClip, CompositeAudioClip

def compose_video_with_audio(
    video_file,
    voice_file,
    background_music_file,
    output_file,
    voice_volume=1.0,
    music_volume=0.3
):
    """
    åˆæˆè§†é¢‘ã€é…éŸ³å’ŒèƒŒæ™¯éŸ³ä¹

    Args:
        video_file: è¾“å…¥è§†é¢‘æ–‡ä»¶
        voice_file: é…éŸ³æ–‡ä»¶
        background_music_file: èƒŒæ™¯éŸ³ä¹æ–‡ä»¶
        output_file: è¾“å‡ºè§†é¢‘æ–‡ä»¶
        voice_volume: é…éŸ³éŸ³é‡ï¼ˆ0.0-1.0ï¼‰
        music_volume: èƒŒæ™¯éŸ³ä¹éŸ³é‡ï¼ˆ0.0-1.0ï¼‰
    """
    video = VideoFileClip(video_file)
    voice_audio = AudioFileClip(voice_file).volumex(voice_volume)

    # èƒŒæ™¯éŸ³ä¹å¾ªç¯æˆ–è£å‰ªä»¥åŒ¹é…è§†é¢‘é•¿åº¦
    bg_music = AudioFileClip(background_music_file).volumex(music_volume)
    if bg_music.duration < video.duration:
        # å¾ªç¯æ’­æ”¾
        bg_music = bg_music.audio_loop(duration=video.duration)
    else:
        # è£å‰ª
        bg_music = bg_music.subclip(0, video.duration)

    # æ··åˆéŸ³é¢‘
    final_audio = CompositeAudioClip([voice_audio, bg_music])
    video = video.set_audio(final_audio)

    # å¯¼å‡º
    video.write_videofile(
        output_file,
        codec='libx264',
        audio_codec='aac',
        bitrate='5000k'
    )
```

---

## æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 1. è¯­éŸ³æœåŠ¡æ¨¡å— (`py/services/voice_service.py`)

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
è¯­éŸ³åˆæˆæœåŠ¡æ¨¡å—
æ”¯æŒ Edge TTS å’Œ Qwen TTS
"""

import asyncio
import edge_tts
from pathlib import Path
from typing import Optional, Tuple
import requests
from loguru import logger

class VoiceService:
    """è¯­éŸ³åˆæˆæœåŠ¡"""

    def __init__(self, provider="edge", api_key=None):
        """
        åˆå§‹åŒ–è¯­éŸ³æœåŠ¡

        Args:
            provider: æœåŠ¡æä¾›å•†ï¼Œ"edge" æˆ– "qwen"
            api_key: WavespeedAI API Keyï¼ˆä»…qwenéœ€è¦ï¼‰
        """
        self.provider = provider
        self.api_key = api_key

    def generate_audio_edge(
        self,
        text: str,
        output_file: str,
        voice_name: str = "zh-CN-XiaoxiaoNeural"
    ) -> Tuple[Optional[object], float]:
        """
        ä½¿ç”¨Edge TTSç”Ÿæˆé…éŸ³

        Args:
            text: æ—ç™½æ–‡æ¡ˆ
            output_file: è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„
            voice_name: éŸ³è‰²åç§°

        Returns:
            (sub_maker, duration): SubMakerå¯¹è±¡å’ŒéŸ³é¢‘æ—¶é•¿
        """
        try:
            async def _generate():
                communicate = edge_tts.Communicate(text, voice_name)
                sub_maker = edge_tts.SubMaker()

                with open(output_file, "wb") as file:
                    async for chunk in communicate.stream():
                        if chunk["type"] == "audio":
                            file.write(chunk["data"])
                        elif chunk["type"] == "WordBoundary":
                            sub_maker.create_sub(
                                (chunk["offset"], chunk["duration"]),
                                chunk["text"]
                            )

                return sub_maker

            sub_maker = asyncio.run(_generate())

            # è®¡ç®—éŸ³é¢‘æ—¶é•¿
            duration = 0.0
            if sub_maker and sub_maker.offset:
                duration = sub_maker.offset[-1][1] / 10000000

            logger.success(f"âœ… Edge TTS ç”ŸæˆæˆåŠŸ: {output_file}, æ—¶é•¿: {duration:.2f}s")
            return sub_maker, duration

        except Exception as e:
            logger.error(f"âŒ Edge TTS ç”Ÿæˆå¤±è´¥: {str(e)}")
            return None, 0.0

    def generate_audio_qwen(
        self,
        text: str,
        output_file: str,
        voice_name: str = "default"
    ) -> Tuple[None, float]:
        """
        ä½¿ç”¨Qwen TTSç”Ÿæˆé…éŸ³

        Args:
            text: æ—ç™½æ–‡æ¡ˆ
            output_file: è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„
            voice_name: éŸ³è‰²åç§°

        Returns:
            (None, duration): Qwenä¸è¿”å›SubMakerï¼Œåªè¿”å›æ—¶é•¿
        """
        # TODO: å®ç°Qwen TTSè°ƒç”¨
        # å‚è€ƒWavespeedAI APIæ–‡æ¡£
        logger.warning("âš ï¸ Qwen TTS æš‚æœªå®ç°")
        return None, 0.0

    def generate_audio(
        self,
        text: str,
        output_file: str,
        voice_name: str = "zh-CN-XiaoxiaoNeural"
    ) -> Tuple[Optional[object], float]:
        """
        ç”Ÿæˆé…éŸ³ï¼ˆè‡ªåŠ¨é€‰æ‹©æä¾›å•†ï¼‰

        Args:
            text: æ—ç™½æ–‡æ¡ˆ
            output_file: è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„
            voice_name: éŸ³è‰²åç§°

        Returns:
            (sub_maker, duration): SubMakerå¯¹è±¡ï¼ˆä»…Edgeï¼‰å’ŒéŸ³é¢‘æ—¶é•¿
        """
        if self.provider == "edge":
            return self.generate_audio_edge(text, output_file, voice_name)
        elif self.provider == "qwen":
            return self.generate_audio_qwen(text, output_file, voice_name)
        else:
            raise ValueError(f"ä¸æ”¯æŒçš„provider: {self.provider}")

    @staticmethod
    def get_available_voices(language="zh-CN"):
        """
        è·å–å¯ç”¨éŸ³è‰²åˆ—è¡¨

        Args:
            language: è¯­è¨€ä»£ç ï¼Œå¦‚"zh-CN"

        Returns:
            list: éŸ³è‰²åç§°åˆ—è¡¨
        """
        # Edge TTS å¸¸ç”¨ä¸­æ–‡éŸ³è‰²
        voices = {
            "zh-CN": [
                "zh-CN-XiaoxiaoNeural-Female",  # æ™“æ™“ï¼ˆå¥³ï¼‰
                "zh-CN-XiaoyiNeural-Female",     # æ™“ä¼Šï¼ˆå¥³ï¼‰
                "zh-CN-YunjianNeural-Male",      # äº‘å¥ï¼ˆç”·ï¼‰
                "zh-CN-YunxiNeural-Male",        # äº‘å¸Œï¼ˆç”·ï¼‰
                "zh-CN-YunxiaNeural-Male",       # äº‘å¤ï¼ˆç”·ï¼‰
                "zh-CN-YunyangNeural-Male",      # äº‘æ‰¬ï¼ˆç”·ï¼‰
            ]
        }
        return voices.get(language, [])
```

---

### 2. å­—å¹•æœåŠ¡æ¨¡å— (`py/services/subtitle_service.py`)

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å­—å¹•ç”ŸæˆæœåŠ¡æ¨¡å—
æ”¯æŒ SubMakerã€Whisperã€ç®€å•æ–‡æ¡ˆä¸‰ç§æ–¹å¼
"""

import re
from pathlib import Path
from typing import List, Dict
from edge_tts.submaker import mktimestamp
from loguru import logger

class SubtitleService:
    """å­—å¹•ç”ŸæˆæœåŠ¡"""

    def __init__(self, provider="submaker", api_key=None):
        """
        åˆå§‹åŒ–å­—å¹•æœåŠ¡

        Args:
            provider: æœåŠ¡æä¾›å•†ï¼Œ"submaker", "whisper", "simple"
            api_key: WavespeedAI API Keyï¼ˆä»…whisperéœ€è¦ï¼‰
        """
        self.provider = provider
        self.api_key = api_key

    @staticmethod
    def split_by_punctuation(text: str) -> List[str]:
        """
        æŒ‰æ ‡ç‚¹ç¬¦å·åˆ†å‰²æ–‡æœ¬

        Args:
            text: è¾“å…¥æ–‡æœ¬

        Returns:
            list: åˆ†å‰²åçš„å¥å­åˆ—è¡¨
        """
        # ä¸­æ–‡å’Œè‹±æ–‡æ ‡ç‚¹ç¬¦å·
        punctuations = r'[ã€‚ï¼ï¼Ÿï¼Œï¼›ï¼šã€,.!?;:\n]'
        lines = re.split(punctuations, text)
        return [line.strip() for line in lines if line.strip()]

    def create_from_submaker(
        self,
        sub_maker: object,
        script_text: str,
        output_file: str
    ) -> bool:
        """
        ä»Edge TTSçš„SubMakerç”Ÿæˆå­—å¹•

        Args:
            sub_maker: Edge TTSè¿”å›çš„SubMakerå¯¹è±¡
            script_text: åŸå§‹æ—ç™½æ–‡æ¡ˆ
            output_file: è¾“å‡ºSRTæ–‡ä»¶è·¯å¾„

        Returns:
            bool: æ˜¯å¦æˆåŠŸ
        """
        try:
            script_lines = self.split_by_punctuation(script_text)
            subtitles = []

            current_line = ""
            start_time = None
            line_index = 0

            for (offset, duration), word in zip(sub_maker.offset, sub_maker.subs):
                if start_time is None:
                    start_time = offset

                current_line += word.strip()

                # å°è¯•åŒ¹é…è„šæœ¬è¡Œ
                if line_index < len(script_lines):
                    script_line = script_lines[line_index]
                    # ç§»é™¤æ‰€æœ‰éå­—æ¯æ•°å­—å­—ç¬¦è¿›è¡Œæ¯”è¾ƒ
                    current_cleaned = re.sub(r'\W+', '', current_line)
                    script_cleaned = re.sub(r'\W+', '', script_line)

                    if current_cleaned == script_cleaned:
                        end_time = offset + duration
                        subtitles.append({
                            'index': len(subtitles) + 1,
                            'start': self._format_time(start_time),
                            'end': self._format_time(end_time),
                            'text': script_line
                        })
                        current_line = ""
                        start_time = None
                        line_index += 1

            # å†™å…¥SRTæ–‡ä»¶
            self._write_srt(subtitles, output_file)
            logger.success(f"âœ… å­—å¹•ç”ŸæˆæˆåŠŸ: {output_file}, å…± {len(subtitles)} è¡Œ")
            return True

        except Exception as e:
            logger.error(f"âŒ SubMakerå­—å¹•ç”Ÿæˆå¤±è´¥: {str(e)}")
            return False

    def create_from_simple(
        self,
        script_text: str,
        audio_duration: float,
        output_file: str
    ) -> bool:
        """
        åŸºäºæ–‡æ¡ˆå’ŒéŸ³é¢‘æ—¶é•¿ç”Ÿæˆç®€å•å­—å¹•

        Args:
            script_text: æ—ç™½æ–‡æ¡ˆ
            audio_duration: éŸ³é¢‘æ€»æ—¶é•¿ï¼ˆç§’ï¼‰
            output_file: è¾“å‡ºSRTæ–‡ä»¶è·¯å¾„

        Returns:
            bool: æ˜¯å¦æˆåŠŸ
        """
        try:
            script_lines = self.split_by_punctuation(script_text)

            if not script_lines:
                logger.warning("âš ï¸ æ–‡æ¡ˆä¸ºç©ºï¼Œæ— æ³•ç”Ÿæˆå­—å¹•")
                return False

            # å¹³å‡åˆ†é…æ—¶é—´
            time_per_line = audio_duration / len(script_lines)
            subtitles = []

            for i, line in enumerate(script_lines):
                start = i * time_per_line
                end = (i + 1) * time_per_line

                subtitles.append({
                    'index': i + 1,
                    'start': self._format_time(start * 10000000),  # è½¬æ¢ä¸º100çº³ç§’å•ä½
                    'end': self._format_time(end * 10000000),
                    'text': line
                })

            self._write_srt(subtitles, output_file)
            logger.success(f"âœ… ç®€å•å­—å¹•ç”ŸæˆæˆåŠŸ: {output_file}, å…± {len(subtitles)} è¡Œ")
            return True

        except Exception as e:
            logger.error(f"âŒ ç®€å•å­—å¹•ç”Ÿæˆå¤±è´¥: {str(e)}")
            return False

    def create_from_whisper(
        self,
        audio_file: str,
        output_file: str,
        language: str = "zh"
    ) -> bool:
        """
        ä½¿ç”¨Whisperä»éŸ³é¢‘ç”Ÿæˆå­—å¹•

        Args:
            audio_file: éŸ³é¢‘æ–‡ä»¶è·¯å¾„
            output_file: è¾“å‡ºSRTæ–‡ä»¶è·¯å¾„
            language: è¯­è¨€ä»£ç 

        Returns:
            bool: æ˜¯å¦æˆåŠŸ
        """
        # TODO: å®ç°Whisper APIè°ƒç”¨
        logger.warning("âš ï¸ Whisperå­—å¹•ç”Ÿæˆæš‚æœªå®ç°")
        return False

    @staticmethod
    def _format_time(time_in_100ns: int) -> str:
        """
        æ ¼å¼åŒ–æ—¶é—´ä¸ºSRTæ ¼å¼ï¼ˆHH:MM:SS,mmmï¼‰

        Args:
            time_in_100ns: ä»¥100çº³ç§’ä¸ºå•ä½çš„æ—¶é—´

        Returns:
            str: SRTæ ¼å¼æ—¶é—´å­—ç¬¦ä¸²
        """
        # è½¬æ¢ä¸ºæ¯«ç§’
        total_ms = time_in_100ns / 10000
        hours = int(total_ms / 3600000)
        minutes = int((total_ms % 3600000) / 60000)
        seconds = int((total_ms % 60000) / 1000)
        milliseconds = int(total_ms % 1000)

        return f"{hours:02d}:{minutes:02d}:{seconds:02d},{milliseconds:03d}"

    @staticmethod
    def _write_srt(subtitles: List[Dict], output_file: str):
        """
        å†™å…¥SRTæ–‡ä»¶

        Args:
            subtitles: å­—å¹•åˆ—è¡¨
            output_file: è¾“å‡ºæ–‡ä»¶è·¯å¾„
        """
        with open(output_file, 'w', encoding='utf-8') as f:
            for sub in subtitles:
                f.write(f"{sub['index']}\n")
                f.write(f"{sub['start']} --> {sub['end']}\n")
                f.write(f"{sub['text']}\n\n")
```

---

### 3. è§†é¢‘åˆæˆæ¨¡å— (`py/services/video_composer.py`)

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
è§†é¢‘åˆæˆæœåŠ¡æ¨¡å—
è´Ÿè´£éŸ³è§†é¢‘å­—å¹•çš„æœ€ç»ˆåˆæˆ
"""

import random
from pathlib import Path
from typing import List, Dict, Optional
from moviepy.editor import (
    VideoFileClip,
    AudioFileClip,
    TextClip,
    CompositeVideoClip,
    CompositeAudioClip,
    concatenate_videoclips
)
from moviepy.video.tools import subtitles
from loguru import logger

class VideoComposer:
    """è§†é¢‘åˆæˆå™¨"""

    def __init__(self, temp_dir: str = "./temp"):
        """
        åˆå§‹åŒ–è§†é¢‘åˆæˆå™¨

        Args:
            temp_dir: ä¸´æ—¶æ–‡ä»¶ç›®å½•
        """
        self.temp_dir = Path(temp_dir)
        self.temp_dir.mkdir(parents=True, exist_ok=True)

    def add_audio_to_video(
        self,
        video_file: str,
        audio_file: str,
        output_file: str
    ) -> bool:
        """
        ä¸ºè§†é¢‘æ·»åŠ éŸ³é¢‘

        Args:
            video_file: è¾“å…¥è§†é¢‘æ–‡ä»¶
            audio_file: éŸ³é¢‘æ–‡ä»¶
            output_file: è¾“å‡ºè§†é¢‘æ–‡ä»¶

        Returns:
            bool: æ˜¯å¦æˆåŠŸ
        """
        try:
            video = VideoFileClip(video_file)
            audio = AudioFileClip(audio_file)

            # å¦‚æœéŸ³é¢‘é•¿äºè§†é¢‘ï¼Œè£å‰ªéŸ³é¢‘
            if audio.duration > video.duration:
                audio = audio.subclip(0, video.duration)
            # å¦‚æœéŸ³é¢‘çŸ­äºè§†é¢‘ï¼Œå»¶é•¿è§†é¢‘
            elif audio.duration < video.duration:
                video = video.subclip(0, audio.duration)

            video = video.set_audio(audio)
            video.write_videofile(
                output_file,
                codec='libx264',
                audio_codec='aac',
                logger=None
            )

            video.close()
            audio.close()

            logger.success(f"âœ… éŸ³é¢‘æ·»åŠ æˆåŠŸ: {output_file}")
            return True

        except Exception as e:
            logger.error(f"âŒ éŸ³é¢‘æ·»åŠ å¤±è´¥: {str(e)}")
            return False

    def add_subtitles_to_video(
        self,
        video_file: str,
        subtitle_file: str,
        output_file: str,
        style_config: Optional[Dict] = None
    ) -> bool:
        """
        ä¸ºè§†é¢‘æ·»åŠ å­—å¹•

        Args:
            video_file: è¾“å…¥è§†é¢‘æ–‡ä»¶
            subtitle_file: SRTå­—å¹•æ–‡ä»¶
            output_file: è¾“å‡ºè§†é¢‘æ–‡ä»¶
            style_config: å­—å¹•æ ·å¼é…ç½®

        Returns:
            bool: æ˜¯å¦æˆåŠŸ
        """
        try:
            if style_config is None:
                style_config = self._default_subtitle_style()

            video = VideoFileClip(video_file)

            # å­—å¹•ç”Ÿæˆå™¨
            def generator(txt):
                return TextClip(
                    txt,
                    font=style_config.get('font', 'STHeiti'),
                    fontsize=style_config.get('fontsize', 48),
                    color=style_config.get('color', 'white'),
                    stroke_color=style_config.get('stroke_color', 'black'),
                    stroke_width=style_config.get('stroke_width', 2),
                    method='caption',
                    size=(int(video.w * 0.9), None),
                    align='center'
                )

            # è¯»å–å­—å¹•
            subs = subtitles.file_to_subtitles(subtitle_file, encoding='utf-8')

            # åˆ›å»ºå­—å¹•clips
            subtitle_clips = []
            for ((start, end), txt) in subs:
                clip = generator(txt)
                clip = clip.set_position(('center', 'bottom'))
                clip = clip.set_start(start)
                clip = clip.set_duration(end - start)
                subtitle_clips.append(clip)

            # åˆæˆ
            final = CompositeVideoClip([video] + subtitle_clips)
            final.write_videofile(
                output_file,
                codec='libx264',
                audio_codec='aac',
                logger=None
            )

            video.close()
            final.close()

            logger.success(f"âœ… å­—å¹•æ·»åŠ æˆåŠŸ: {output_file}")
            return True

        except Exception as e:
            logger.error(f"âŒ å­—å¹•æ·»åŠ å¤±è´¥: {str(e)}")
            return False

    def add_background_music(
        self,
        video_file: str,
        music_file: str,
        output_file: str,
        voice_volume: float = 1.0,
        music_volume: float = 0.3
    ) -> bool:
        """
        ä¸ºè§†é¢‘æ·»åŠ èƒŒæ™¯éŸ³ä¹

        Args:
            video_file: è¾“å…¥è§†é¢‘æ–‡ä»¶ï¼ˆå·²æœ‰é…éŸ³ï¼‰
            music_file: èƒŒæ™¯éŸ³ä¹æ–‡ä»¶
            output_file: è¾“å‡ºè§†é¢‘æ–‡ä»¶
            voice_volume: é…éŸ³éŸ³é‡ï¼ˆ0.0-1.0ï¼‰
            music_volume: èƒŒæ™¯éŸ³ä¹éŸ³é‡ï¼ˆ0.0-1.0ï¼‰

        Returns:
            bool: æ˜¯å¦æˆåŠŸ
        """
        try:
            video = VideoFileClip(video_file)
            bg_music = AudioFileClip(music_file).volumex(music_volume)

            # èƒŒæ™¯éŸ³ä¹å¾ªç¯æˆ–è£å‰ª
            if bg_music.duration < video.duration:
                bg_music = bg_music.audio_loop(duration=video.duration)
            else:
                bg_music = bg_music.subclip(0, video.duration)

            # æ··åˆåŸéŸ³é¢‘å’ŒèƒŒæ™¯éŸ³ä¹
            if video.audio:
                voice_audio = video.audio.volumex(voice_volume)
                final_audio = CompositeAudioClip([voice_audio, bg_music])
            else:
                final_audio = bg_music

            video = video.set_audio(final_audio)
            video.write_videofile(
                output_file,
                codec='libx264',
                audio_codec='aac',
                logger=None
            )

            video.close()
            bg_music.close()

            logger.success(f"âœ… èƒŒæ™¯éŸ³ä¹æ·»åŠ æˆåŠŸ: {output_file}")
            return True

        except Exception as e:
            logger.error(f"âŒ èƒŒæ™¯éŸ³ä¹æ·»åŠ å¤±è´¥: {str(e)}")
            return False

    def concatenate_videos(
        self,
        video_files: List[str],
        output_file: str,
        transition_duration: float = 0.5
    ) -> bool:
        """
        æ‹¼æ¥å¤šä¸ªè§†é¢‘

        Args:
            video_files: è§†é¢‘æ–‡ä»¶åˆ—è¡¨
            output_file: è¾“å‡ºè§†é¢‘æ–‡ä»¶
            transition_duration: è½¬åœºæ—¶é•¿ï¼ˆç§’ï¼‰

        Returns:
            bool: æ˜¯å¦æˆåŠŸ
        """
        try:
            clips = [VideoFileClip(f) for f in video_files]

            # ç®€å•æ‹¼æ¥ï¼ˆä¸æ·»åŠ è½¬åœºæ•ˆæœï¼‰
            final = concatenate_videoclips(clips, method="compose")

            final.write_videofile(
                output_file,
                codec='libx264',
                audio_codec='aac',
                logger=None
            )

            for clip in clips:
                clip.close()
            final.close()

            logger.success(f"âœ… è§†é¢‘æ‹¼æ¥æˆåŠŸ: {output_file}, å…± {len(video_files)} ä¸ªç‰‡æ®µ")
            return True

        except Exception as e:
            logger.error(f"âŒ è§†é¢‘æ‹¼æ¥å¤±è´¥: {str(e)}")
            return False

    @staticmethod
    def get_random_music(music_dir: str = "./resource/songs") -> Optional[str]:
        """
        ä»éŸ³ä¹åº“éšæœºé€‰æ‹©èƒŒæ™¯éŸ³ä¹

        Args:
            music_dir: éŸ³ä¹ç›®å½•

        Returns:
            str: éŸ³ä¹æ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœç›®å½•ä¸ºç©ºè¿”å›None
        """
        music_path = Path(music_dir)
        if not music_path.exists():
            logger.warning(f"âš ï¸ éŸ³ä¹ç›®å½•ä¸å­˜åœ¨: {music_dir}")
            return None

        music_files = list(music_path.glob("*.mp3")) + list(music_path.glob("*.wav"))

        if not music_files:
            logger.warning(f"âš ï¸ éŸ³ä¹ç›®å½•ä¸ºç©º: {music_dir}")
            return None

        selected = random.choice(music_files)
        logger.info(f"ğŸµ éšæœºé€‰æ‹©èƒŒæ™¯éŸ³ä¹: {selected.name}")
        return str(selected)

    @staticmethod
    def _default_subtitle_style() -> Dict:
        """
        é»˜è®¤å­—å¹•æ ·å¼

        Returns:
            dict: æ ·å¼é…ç½®
        """
        return {
            'font': 'STHeiti',           # macOSä¸­æ–‡å­—ä½“
            'fontsize': 48,              # å­—å·
            'color': 'white',            # å­—ä½“é¢œè‰²
            'stroke_color': 'black',     # æè¾¹é¢œè‰²
            'stroke_width': 2,           # æè¾¹å®½åº¦
        }
```

---

## å·¥ä½œæµæ”¹è¿›

### ç°æœ‰æµç¨‹ vs æ–°æµç¨‹

#### ç°æœ‰æµç¨‹ï¼ˆ4é˜¶æ®µï¼‰

```
é˜¶æ®µ0: é…ç½®ä¸äº¤äº’
é˜¶æ®µ1: æ•…äº‹ç”Ÿæˆï¼ˆDeepSeekï¼‰
é˜¶æ®µ2: å›¾åƒ+è§†é¢‘ç”Ÿæˆï¼ˆWavespeedAIï¼‰
  â”œâ”€â”€ 2a: å¹¶å‘ç”Ÿæˆå›¾åƒ
  â””â”€â”€ 2b: ä¸²è¡Œç”Ÿæˆè§†é¢‘
é˜¶æ®µ3: è§†é¢‘åˆæˆï¼ˆFFmpeg/MoviePyï¼‰
```

#### æ–°æµç¨‹ï¼ˆ5é˜¶æ®µï¼‰

```
é˜¶æ®µ0: é…ç½®ä¸äº¤äº’
é˜¶æ®µ1: æ•…äº‹ç”Ÿæˆï¼ˆDeepSeekï¼‰
é˜¶æ®µ2: é…éŸ³+å­—å¹•ç”Ÿæˆï¼ˆæ–°å¢ï¼‰â­
  â”œâ”€â”€ 2a: é…éŸ³ç”Ÿæˆï¼ˆEdge TTSï¼‰
  â””â”€â”€ 2b: å­—å¹•ç”Ÿæˆï¼ˆSubMakerï¼‰
é˜¶æ®µ3: å›¾åƒ+è§†é¢‘ç”Ÿæˆï¼ˆWavespeedAIï¼‰
  â”œâ”€â”€ 3a: å¹¶å‘ç”Ÿæˆå›¾åƒ
  â””â”€â”€ 3b: ä¸²è¡Œç”Ÿæˆè§†é¢‘
é˜¶æ®µ4: éŸ³è§†é¢‘åˆæˆï¼ˆMoviePyï¼‰â­
  â”œâ”€â”€ 4a: è§†é¢‘+é…éŸ³åˆæˆ
  â”œâ”€â”€ 4b: æ·»åŠ å­—å¹•è½¨é“
  â”œâ”€â”€ 4c: æ··åˆèƒŒæ™¯éŸ³ä¹
  â””â”€â”€ 4d: æ‹¼æ¥æ‰€æœ‰é•œå¤´
```

### æ–­ç‚¹ç»­ä¼ ç­–ç•¥

**æ–°å¢æ£€æŸ¥ç‚¹**
```python
checkpoint = {
    "story_complete": bool,      # ç°æœ‰
    "images_complete": list,     # ç°æœ‰
    "videos_complete": list,     # ç°æœ‰
    "audios_complete": list,     # æ–°å¢ â­
    "subtitles_complete": list,  # æ–°å¢ â­
    "background_music": str,     # æ–°å¢ â­
}
```

**æ™ºèƒ½è·³è¿‡é€»è¾‘**
- å·²æœ‰ `shot_X_audio.mp3` â†’ è·³è¿‡é…éŸ³ç”Ÿæˆ
- å·²æœ‰ `shot_X_subtitle.srt` â†’ è·³è¿‡å­—å¹•ç”Ÿæˆ
- å·²æœ‰ `background_music.mp3` â†’ è·³è¿‡éŸ³ä¹é€‰æ‹©

---

## é…ç½®è¯´æ˜

### config.yaml æ–°å¢é…ç½®

```yaml
# éŸ³é¢‘é…ç½®
audio:
  # è¯­éŸ³åˆæˆè®¾ç½®
  voice_provider: "edge"  # é€‰é¡¹: edge, qwen
  voice_name: "zh-CN-XiaoxiaoNeural"  # Edge TTSéŸ³è‰²
  voice_volume: 1.0  # é…éŸ³éŸ³é‡ (0.0-1.0)

  # èƒŒæ™¯éŸ³ä¹è®¾ç½®
  enable_background_music: true
  music_source: "local"  # é€‰é¡¹: local, ai
  music_dir: "./resource/songs"
  music_volume: 0.3  # èƒŒæ™¯éŸ³ä¹éŸ³é‡ (0.0-1.0)

# å­—å¹•é…ç½®
subtitle:
  # å­—å¹•ç”Ÿæˆè®¾ç½®
  subtitle_provider: "submaker"  # é€‰é¡¹: submaker, whisper, simple
  language: "zh"

  # å­—å¹•æ ·å¼
  font_name: "STHeiti"  # macOSä¸­æ–‡å­—ä½“ï¼ŒWindowsç”¨"Microsoft YaHei"
  font_size: 48
  font_color: "white"
  outline_color: "black"
  outline_width: 2
  position: "bottom"  # é€‰é¡¹: top, center, bottom

# è§†é¢‘åˆæˆé…ç½®
composer:
  video_codec: "libx264"
  audio_codec: "aac"
  bitrate: "5000k"
  transition_duration: 0.5  # è½¬åœºæ—¶é•¿ï¼ˆç§’ï¼‰
```

### éŸ³è‰²é€‰é¡¹è¯´æ˜

**ä¸­æ–‡å¥³å£°ï¼ˆæ¨èï¼‰**
- `zh-CN-XiaoxiaoNeural` - æ™“æ™“ï¼ˆæ¸©æŸ”ï¼‰
- `zh-CN-XiaoyiNeural` - æ™“ä¼Šï¼ˆæ´»æ³¼ï¼‰

**ä¸­æ–‡ç”·å£°ï¼ˆæ¨èï¼‰**
- `zh-CN-YunxiNeural` - äº‘å¸Œï¼ˆæˆç†Ÿï¼‰
- `zh-CN-YunyangNeural` - äº‘æ‰¬ï¼ˆå¹´è½»ï¼‰

**å®Œæ•´éŸ³è‰²åˆ—è¡¨**: è¿è¡Œ `VoiceService.get_available_voices()` æŸ¥çœ‹

---

## æˆæœ¬åˆ†æ

### æ–¹æ¡ˆAï¼ˆæ··åˆæ–¹æ¡ˆï¼‰æˆæœ¬æ˜ç»†

#### å•é•œå¤´æˆæœ¬

| é¡¹ç›® | æä¾›å•† | æˆæœ¬ |
|------|--------|------|
| æ•…äº‹ç”Ÿæˆ | DeepSeek | ~$0.001 |
| å›¾åƒç”Ÿæˆ | Seedream v4 | $0.027 |
| è§†é¢‘ç”Ÿæˆ | WAN 2.5 I2V | $0.30 |
| é…éŸ³ç”Ÿæˆ | Edge TTS | $0 |
| å­—å¹•ç”Ÿæˆ | SubMaker | $0 |
| èƒŒæ™¯éŸ³ä¹ | æœ¬åœ°éŸ³ä¹åº“ | $0 |
| **åˆè®¡** | - | **$0.328** |

#### å®Œæ•´è§†é¢‘æˆæœ¬

| é•œå¤´æ•° | æ€»æˆæœ¬ | å¯¹æ¯”Moneyé¡¹ç›® |
|--------|--------|--------------|
| 3é•œå¤´ 720p | $0.98 | Money: ~$0 (ç”¨å…è´¹ç´ æ) |
| 5é•œå¤´ 720p | $1.64 | Money: ~$0 |
| 10é•œå¤´ 1080p | $5.00 | Money: ~$0 |

**æˆæœ¬å·®å¼‚åŸå› **ï¼š
- wavespeed ä½¿ç”¨AIç”Ÿæˆè§†é¢‘ï¼ˆé«˜è´¨é‡ï¼Œæœ‰æˆæœ¬ï¼‰
- Money ä½¿ç”¨å…è´¹è§†é¢‘ç´ æåº“ï¼ˆPexelsï¼‰

**æ€§ä»·æ¯”åˆ†æ**ï¼š
- âœ… æ¯”åŸæ–¹æ¡ˆï¼ˆæ— é…éŸ³å­—å¹•ï¼‰**é›¶æˆæœ¬å¢åŠ **
- âœ… æ¯”æ–¹æ¡ˆBï¼ˆå…¨WavespeedAIï¼‰**èŠ‚çœçº¦30%**
- âœ… è§†é¢‘è´¨é‡è¿œè¶…ç´ ææ‹¼æ¥æ–¹æ¡ˆ

---

## å¼€å‘è·¯çº¿å›¾

### é˜¶æ®µ1ï¼šåŸºç¡€åŠŸèƒ½éªŒè¯ï¼ˆ1-2å¤©ï¼‰

**ç›®æ ‡**ï¼šéªŒè¯Edge TTSå’ŒSubMakerå¯ç”¨æ€§

**ä»»åŠ¡**ï¼š
- [x] ç ”è¯»Moneyé¡¹ç›®voice.pyå’Œsubtitle.py
- [ ] ç¼–å†™Edge TTSæµ‹è¯•è„šæœ¬
- [ ] æµ‹è¯•SubMakerå­—å¹•ç”Ÿæˆ
- [ ] éªŒè¯MoviePyå­—å¹•æ¸²æŸ“
- [ ] æµ‹è¯•éŸ³é¢‘æ··åˆåŠŸèƒ½

**äº¤ä»˜ç‰©**ï¼š
- `test/test-edge-tts.py` - Edge TTSæµ‹è¯•
- `test/test-subtitle.py` - å­—å¹•ç”Ÿæˆæµ‹è¯•
- `test/test-composer.py` - éŸ³è§†é¢‘åˆæˆæµ‹è¯•

---

### é˜¶æ®µ2ï¼šæ ¸å¿ƒæ¨¡å—å¼€å‘ï¼ˆ2-3å¤©ï¼‰

**ç›®æ ‡**ï¼šå®ç°è¯­éŸ³ã€å­—å¹•ã€åˆæˆä¸‰å¤§æ¨¡å—

**ä»»åŠ¡**ï¼š
- [ ] å®ç° `VoiceService` ç±»
- [ ] å®ç° `SubtitleService` ç±»
- [ ] å®ç° `VideoComposer` ç±»
- [ ] æ·»åŠ é…ç½®å‚æ•°åˆ°config.yaml
- [ ] æ›´æ–°requirements.txtä¾èµ–

**äº¤ä»˜ç‰©**ï¼š
- `py/services/voice_service.py`
- `py/services/subtitle_service.py`
- `py/services/video_composer.py`
- æ›´æ–° `requirements.txt`

---

### é˜¶æ®µ3ï¼šä¸»æµç¨‹é›†æˆï¼ˆ2-3å¤©ï¼‰

**ç›®æ ‡**ï¼šé›†æˆåˆ°ad-aka.pyä¸»æµç¨‹

**ä»»åŠ¡**ï¼š
- [ ] ä¿®æ”¹ `ad-aka.py` ä¸»æµç¨‹
- [ ] æ·»åŠ é˜¶æ®µ2ï¼ˆé…éŸ³+å­—å¹•ç”Ÿæˆï¼‰
- [ ] ä¿®æ”¹é˜¶æ®µ4ï¼ˆéŸ³è§†é¢‘åˆæˆï¼‰
- [ ] æ›´æ–°æ–­ç‚¹ç»­ä¼ é€»è¾‘
- [ ] æ·»åŠ è¿›åº¦æ˜¾ç¤º

**ä¸»è¦ä¿®æ”¹ç‚¹**ï¼š
```python
# ad-aka.py æ–°å¢é˜¶æ®µ

# === é˜¶æ®µ2: é…éŸ³å’Œå­—å¹•ç”Ÿæˆ ===
def stage2_voice_and_subtitle():
    voice_service = VoiceService(provider="edge")
    subtitle_service = SubtitleService(provider="submaker")

    for i, shot in enumerate(shots):
        # 2a. ç”Ÿæˆé…éŸ³
        audio_file = f"{WORK_DIR}/shot_{i+1}_audio.mp3"
        if not os.path.exists(audio_file):
            sub_maker, duration = voice_service.generate_audio(
                text=shot["narration"],
                output_file=audio_file,
                voice_name=config["voice_name"]
            )

            # 2b. ç”Ÿæˆå­—å¹•
            subtitle_file = f"{WORK_DIR}/shot_{i+1}_subtitle.srt"
            subtitle_service.create_from_submaker(
                sub_maker=sub_maker,
                script_text=shot["narration"],
                output_file=subtitle_file
            )

# === é˜¶æ®µ4: éŸ³è§†é¢‘åˆæˆ ===
def stage4_compose():
    composer = VideoComposer(temp_dir=WORK_DIR)

    # 4a. ä¸ºæ¯ä¸ªé•œå¤´æ·»åŠ é…éŸ³
    for i in range(shot_count):
        video_file = f"{WORK_DIR}/shot_{i+1}.mp4"
        audio_file = f"{WORK_DIR}/shot_{i+1}_audio.mp3"
        output_file = f"{WORK_DIR}/shot_{i+1}_with_audio.mp4"
        composer.add_audio_to_video(video_file, audio_file, output_file)

    # 4b. ä¸ºæ¯ä¸ªé•œå¤´æ·»åŠ å­—å¹•
    for i in range(shot_count):
        video_file = f"{WORK_DIR}/shot_{i+1}_with_audio.mp4"
        subtitle_file = f"{WORK_DIR}/shot_{i+1}_subtitle.srt"
        output_file = f"{WORK_DIR}/shot_{i+1}_final.mp4"
        composer.add_subtitles_to_video(
            video_file,
            subtitle_file,
            output_file,
            style_config=config["subtitle_style"]
        )

    # 4c. æ‹¼æ¥æ‰€æœ‰é•œå¤´
    video_files = [f"{WORK_DIR}/shot_{i+1}_final.mp4" for i in range(shot_count)]
    temp_output = f"{WORK_DIR}/temp_final.mp4"
    composer.concatenate_videos(video_files, temp_output)

    # 4d. æ·»åŠ èƒŒæ™¯éŸ³ä¹
    if config["enable_background_music"]:
        music_file = composer.get_random_music(config["music_dir"])
        if music_file:
            final_output = f"{WORK_DIR}/final_video.mp4"
            composer.add_background_music(
                temp_output,
                music_file,
                final_output,
                music_volume=config["music_volume"]
            )
```

**äº¤ä»˜ç‰©**ï¼š
- æ›´æ–°çš„ `py/ad-aka.py`
- æ›´æ–°çš„ `CLAUDE.md`

---

### é˜¶æ®µ4ï¼šèƒŒæ™¯éŸ³ä¹åº“ï¼ˆ1å¤©ï¼‰

**ç›®æ ‡**ï¼šå»ºç«‹æœ¬åœ°éŸ³ä¹åº“

**ä»»åŠ¡**ï¼š
- [ ] åˆ›å»º `resource/songs/` ç›®å½•
- [ ] æ”¶é›†æ— ç‰ˆæƒèƒŒæ™¯éŸ³ä¹
- [ ] åˆ†ç±»æ•´ç†ï¼ˆè½»æ¾/å²è¯—/ç§‘æŠ€ç­‰ï¼‰
- [ ] ç¼–å†™éŸ³ä¹é€‰æ‹©é€»è¾‘

**æ¨èéŸ³ä¹æ¥æº**ï¼ˆæ— ç‰ˆæƒï¼‰ï¼š
- YouTube Audio Library
- Incompetechï¼ˆKevin MacLeodï¼‰
- Free Music Archive
- Bensound

**äº¤ä»˜ç‰©**ï¼š
- `resource/songs/` éŸ³ä¹åº“
- åˆ†ç±»è¯´æ˜æ–‡æ¡£

---

### é˜¶æ®µ5ï¼šä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆ2-3å¤©ï¼‰

**ç›®æ ‡**ï¼šå®Œå–„ç»†èŠ‚ï¼Œæµ‹è¯•ç¨³å®šæ€§

**ä»»åŠ¡**ï¼š
- [ ] å­—å¹•æ ·å¼ä¼˜åŒ–ï¼ˆå­—ä½“ã€é¢œè‰²ã€æè¾¹ï¼‰
- [ ] éŸ³é‡å¹³è¡¡è°ƒä¼˜
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆå¹¶å‘å¤„ç†ï¼‰
- [ ] é”™è¯¯å¤„ç†å¢å¼º
- [ ] å®Œæ•´æµç¨‹æµ‹è¯•ï¼ˆ3é•œå¤´ã€5é•œå¤´ã€10é•œå¤´ï¼‰
- [ ] æ–‡æ¡£æ›´æ–°

**æµ‹è¯•åœºæ™¯**ï¼š
1. 3é•œå¤´ç§‘æŠ€é£è§†é¢‘ï¼ˆ480pï¼‰
2. 5é•œå¤´ä»™ä¾ é£è§†é¢‘ï¼ˆ720pï¼‰
3. 10é•œå¤´ç”µå½±é£è§†é¢‘ï¼ˆ1080pï¼‰
4. æ–­ç‚¹ç»­ä¼ æµ‹è¯•ï¼ˆå„é˜¶æ®µä¸­æ–­ï¼‰
5. å¼‚å¸¸æƒ…å†µæµ‹è¯•ï¼ˆAPIå¤±è´¥ã€æ–‡ä»¶æŸåï¼‰

**äº¤ä»˜ç‰©**ï¼š
- æµ‹è¯•æŠ¥å‘Š
- æ€§èƒ½åŸºå‡†æ•°æ®
- æ›´æ–°çš„README.md
- æ›´æ–°çš„CLAUDE.md

---

## æŠ€æœ¯ä¾èµ–

### æ–°å¢PythonåŒ…

```txt
# requirements.txt æ–°å¢

# è¯­éŸ³åˆæˆ
edge-tts>=6.1.9              # Microsoft Edge TTS

# è§†é¢‘ç¼–è¾‘å’Œåˆæˆ
moviepy>=1.0.3               # è§†é¢‘ç¼–è¾‘æ ¸å¿ƒåº“
pillow>=10.0.0               # å›¾åƒå¤„ç†ï¼ˆMoviePyä¾èµ–ï¼‰
numpy>=1.24.0                # æ•°å€¼è®¡ç®—ï¼ˆMoviePyä¾èµ–ï¼‰

# æ—¥å¿—
loguru>=0.7.2                # æ›´å¥½çš„æ—¥å¿—åº“

# å¯é€‰ï¼šæœ¬åœ°Whisperï¼ˆå¦‚æœä¸ç”¨WavespeedAIï¼‰
# faster-whisper>=0.9.0      # æœ¬åœ°Whisper
# openai-whisper>=20231117   # OpenAIå®˜æ–¹Whisper
```

### å®‰è£…å‘½ä»¤

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# å®‰è£…æ–°ä¾èµ–
pip install edge-tts>=6.1.9 moviepy>=1.0.3 pillow>=10.0.0 loguru>=0.7.2

# æˆ–è€…ä»requirements.txtå®‰è£…
pip install -r requirements.txt
```

### ç³»ç»Ÿä¾èµ–

**macOS**ï¼š
```bash
# å®‰è£…ImageMagickï¼ˆMoviePyå­—å¹•éœ€è¦ï¼‰
brew install imagemagick

# å®‰è£…ä¸­æ–‡å­—ä½“
# ç³»ç»Ÿè‡ªå¸¦STHeitiï¼Œæ— éœ€é¢å¤–å®‰è£…
```

**Linuxï¼ˆUbuntu/Debianï¼‰**ï¼š
```bash
# å®‰è£…FFmpegå’ŒImageMagick
sudo apt-get update
sudo apt-get install ffmpeg imagemagick

# å®‰è£…ä¸­æ–‡å­—ä½“
sudo apt-get install fonts-wqy-zenhei fonts-wqy-microhei
```

**Windows**ï¼š
```powershell
# å®‰è£…FFmpeg
# ä» https://ffmpeg.org/download.html ä¸‹è½½å¹¶æ·»åŠ åˆ°PATH

# å®‰è£…ImageMagick
# ä» https://imagemagick.org/script/download.php ä¸‹è½½å®‰è£…

# ä¸­æ–‡å­—ä½“
# ç³»ç»Ÿè‡ªå¸¦"Microsoft YaHei"ï¼Œæ— éœ€é¢å¤–å®‰è£…
```

---

## ä½¿ç”¨ç¤ºä¾‹

### å¿«é€Ÿå¼€å§‹

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. å‡†å¤‡èƒŒæ™¯éŸ³ä¹ï¼ˆå¯é€‰ï¼‰
mkdir -p resource/songs
# å°†æ— ç‰ˆæƒéŸ³ä¹æ”¾å…¥è¯¥ç›®å½•

# 3. é…ç½®config.yaml
# è®¾ç½® audio.enable_background_music = true

# 4. è¿è¡Œä¸»è„šæœ¬
python3 py/ad-aka.py

# 5. æŒ‰æç¤ºè¾“å…¥ä¸»é¢˜ã€é€‰æ‹©é£æ ¼ç­‰

# 6. ç­‰å¾…ç”Ÿæˆå®Œæˆ
# è¾“å‡ºç›®å½•: output/aka-{timestamp}/
# æœ€ç»ˆè§†é¢‘: output/aka-{timestamp}/final_video.mp4
```

### é…ç½®ç¤ºä¾‹

**åŸºç¡€é…ç½®ï¼ˆæœ€å°åŒ–ï¼‰**ï¼š
```yaml
audio:
  voice_provider: "edge"
  voice_name: "zh-CN-XiaoxiaoNeural"
  enable_background_music: false

subtitle:
  subtitle_provider: "submaker"
  font_name: "STHeiti"
```

**é«˜çº§é…ç½®ï¼ˆå®Œæ•´åŠŸèƒ½ï¼‰**ï¼š
```yaml
audio:
  voice_provider: "edge"
  voice_name: "zh-CN-XiaoxiaoNeural"
  voice_volume: 1.0
  enable_background_music: true
  music_source: "local"
  music_dir: "./resource/songs"
  music_volume: 0.25

subtitle:
  subtitle_provider: "submaker"
  language: "zh"
  font_name: "STHeiti"
  font_size: 52
  font_color: "white"
  outline_color: "black"
  outline_width: 3
  position: "bottom"

composer:
  video_codec: "libx264"
  audio_codec: "aac"
  bitrate: "6000k"
  transition_duration: 0.5
```

---

## å¸¸è§é—®é¢˜

### Q1: Edge TTSæ˜¯å¦éœ€è¦API Keyï¼Ÿ
**A**: ä¸éœ€è¦ã€‚Edge TTSæ˜¯Microsoftæä¾›çš„å…è´¹æœåŠ¡ï¼Œæ— éœ€æ³¨å†Œæˆ–API Keyã€‚

### Q2: å­—å¹•ä¸ºä»€ä¹ˆå’ŒéŸ³é¢‘å¯¹ä¸ä¸Šï¼Ÿ
**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ä½¿ç”¨SubMakeræ–¹æ¡ˆï¼ˆæœ€ç²¾ç¡®ï¼‰
2. ç¡®ä¿æ—ç™½æ–‡æ¡ˆå’Œå®é™…TTSæ–‡æœ¬ä¸€è‡´
3. æ£€æŸ¥æ ‡ç‚¹ç¬¦å·åˆ†å‰²æ˜¯å¦æ­£ç¡®

### Q3: MoviePyæŠ¥é”™æ‰¾ä¸åˆ°ImageMagickï¼Ÿ
**A**: éœ€è¦å®‰è£…ImageMagickï¼š
- macOS: `brew install imagemagick`
- Linux: `sudo apt-get install imagemagick`
- Windows: ä»å®˜ç½‘ä¸‹è½½å®‰è£…

### Q4: ä¸­æ–‡å­—å¹•æ˜¾ç¤ºä¹±ç ï¼Ÿ
**A**: æ£€æŸ¥å­—ä½“é…ç½®ï¼š
- macOS: ä½¿ç”¨ `STHeiti`
- Windows: ä½¿ç”¨ `Microsoft YaHei`
- Linux: ä½¿ç”¨ `WenQuanYi Zen Hei`

### Q5: å¦‚ä½•åˆ‡æ¢åˆ°Qwen TTSï¼Ÿ
**A**:
1. åœ¨config.yamlè®¾ç½® `audio.voice_provider: "qwen"`
2. å®ç° `VoiceService.generate_audio_qwen()` æ–¹æ³•
3. éœ€è¦WavespeedAI API Key

### Q6: èƒŒæ™¯éŸ³ä¹å¤ªå¤§å£°æ€ä¹ˆåŠï¼Ÿ
**A**: åœ¨config.yamlè°ƒæ•´ `audio.music_volume`ï¼Œæ¨èå€¼ 0.2-0.3

---

## æ€»ç»“

### æ ¸å¿ƒä¼˜åŠ¿

1. **é›¶å¢é‡æˆæœ¬** - é…éŸ³å’Œå­—å¹•å®Œå…¨å…è´¹
2. **é«˜è´¨é‡è¾“å‡º** - Edge TTSæ¥è¿‘å•†ä¸šæ°´å¹³
3. **ç²¾ç¡®å¯¹é½** - SubMakeræä¾›å•è¯çº§æ—¶é—´æˆ³
4. **æ˜“äºç»´æŠ¤** - å‚è€ƒæˆç†Ÿé¡¹ç›®ï¼Œä»£ç ç®€æ´
5. **çµæ´»å¯æ‰©å±•** - æ”¯æŒå¤šç§TTS/å­—å¹•æ–¹æ¡ˆåˆ‡æ¢

### æ¨èå®æ–½é¡ºåº

**ç¬¬ä¸€ä¼˜å…ˆçº§**ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰ï¼š
1. âœ… å®ç°Edge TTSé…éŸ³ç”Ÿæˆ
2. âœ… å®ç°SubMakerå­—å¹•ç”Ÿæˆ
3. âœ… å®ç°MoviePyéŸ³è§†é¢‘åˆæˆ

**ç¬¬äºŒä¼˜å…ˆçº§**ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰ï¼š
4. âœ… æ·»åŠ å­—å¹•æ ·å¼è‡ªå®šä¹‰
5. âœ… æ·»åŠ èƒŒæ™¯éŸ³ä¹æ”¯æŒ
6. âœ… é›†æˆåˆ°ä¸»æµç¨‹

**ç¬¬ä¸‰ä¼˜å…ˆçº§**ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰ï¼š
7. â³ å®ç°Qwen TTSï¼ˆWavespeedAIï¼‰
8. â³ å®ç°Whisperå­—å¹•ï¼ˆWavespeedAIï¼‰
9. â³ å®ç°AIéŸ³ä¹ç”Ÿæˆ

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

**ç«‹å³å¼€å§‹**ï¼š
1. âœ… é˜…è¯»æœ¬æ–¹æ¡ˆæ–‡æ¡£
2. â³ å®‰è£…æ–°ä¾èµ–ï¼ˆedge-tts, moviepyï¼‰
3. â³ ç¼–å†™æµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½
4. â³ å®ç°æ ¸å¿ƒä¸‰å¤§æ¨¡å—

**æœ¬å‘¨å®Œæˆ**ï¼š
- â³ æ ¸å¿ƒæ¨¡å—å¼€å‘ï¼ˆé˜¶æ®µ2ï¼‰
- â³ ä¸»æµç¨‹é›†æˆï¼ˆé˜¶æ®µ3ï¼‰

**ä¸‹å‘¨å®Œæˆ**ï¼š
- â³ èƒŒæ™¯éŸ³ä¹åº“å»ºè®¾ï¼ˆé˜¶æ®µ4ï¼‰
- â³ ä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆé˜¶æ®µ5ï¼‰

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Claude Code
**æœ€åæ›´æ–°**: 2025-12-23
**å‚è€ƒé¡¹ç›®**: MoneyPrinterTurbo, WavespeedAI API
**ç›¸å…³æ–‡æ¡£**: `./doc/money.md`, `./wavespeed.md`, `./CLAUDE.md`
